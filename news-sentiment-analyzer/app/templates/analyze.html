<!-- Page for submitting text for sentiment analysis. -->
<!-- Extends the base layout and includes the analysis form. -->
{% extends "base.html" %}
{% import 'bootstrap_wtf.html' as wtf %} <!-- Assuming you have bootstrap_wtf.html or similar -->

{% block title %}Analyze Text - Sentiment Analyzer{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <h1 class="mb-4">Analyze News Sentiment</h1>
        <p>Paste the news text into the box below and click "Analyze Sentiment".</p>

        <!-- Add id for AJAX targeting -->
        <!-- Assuming the route passes the 'form' object -->
        <form id="analysis-form" method="POST" action="{{ url_for('main.analyze') }}" novalidate>
             {{ form.hidden_tag() }} <!-- Include CSRF token -->
             {{ wtf.form_field(form.news_text) }}
             {{ wtf.form_field(form.submit) }}
        </form>

        <!-- Add loading indicator element (hidden by default) -->
        <div id="loading-indicator" style="display: none;" class="text-center mt-3">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p>Analyzing...</p>
        </div>

        <!-- Add element for displaying AJAX results -->
        <div id="ajax-result-display" class="mt-4">
            <!-- AJAX results will be injected here -->
        </div>

        <!-- Keep original result display for non-AJAX fallback or initial load -->
        {% if sentiment_result and not request.is_xhr %}
        <div class="result mt-4 p-3 border rounded bg-light">
            <h2>Analysis Result:</h2>
            <p><strong>{{ sentiment_result }}</strong></p>
            <p><small>This result has been saved to your history.</small></p>
        </div>
        {% endif %}

    </div>
</div>
{% endblock %}