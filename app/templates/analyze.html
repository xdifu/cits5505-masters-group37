{% extends "base.html" %}
{% import 'bootstrap_wtf.html' as wtf %}

{% block title %}Analyze Text - Sentiment Analyzer{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <h1 class="mb-4">Analyze News Sentiment</h1>
        <p>Paste the news text into the box below and click "Analyze Sentiment".</p>

        <form id="analysis-form" method="POST" action="{{ url_for('main.analyze') }}" novalidate>
            {{ form.hidden_tag() }}
            {{ wtf.form_field(form.news_text) }}
            <div class="mb-3">
                {{ form.submit(class='btn btn-primary') }}
            </div>
        </form>

        <!-- Loading indicator -->
        <div id="loading-indicator" style="display: none;" class="text-center mt-3">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p>Analyzing...</p>
        </div>

        <!-- AJAX result area -->
        <div id="ajax-result-display" class="mt-4">
            <!-- AJAX results will be injected here -->
        </div>

        <!-- Non-AJAX fallback result -->
        {% if sentiment_result and not request.is_xhr %}
        <div class="result mt-4 p-3 border rounded bg-light">
            <h2>Analysis Result:</h2>
            <p><strong>{{ sentiment_result }}</strong></p>
            <p><small>This result has been saved to your history.</small></p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}